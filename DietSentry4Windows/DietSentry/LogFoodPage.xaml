<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:DietSentry"
             x:Class="DietSentry.LogFoodPage">

    <Grid>
        <VerticalStackLayout
            Padding="20"
            Spacing="12">
            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="8">
                <Button
                    Grid.Column="0"
                    Text="?"
                    Style="{StaticResource HelpIconButtonStyle}"
                    Clicked="OnHelpClicked" />
                <Label
                    Grid.Column="1"
                    x:Name="FoodNameLabel"
                    FontAttributes="Bold"
                    FontSize="18"
                    VerticalOptions="Center" />
            </Grid>
            <HorizontalStackLayout Spacing="8">
                <Entry
                    x:Name="AmountEntry"
                    Placeholder="Amount"
                    Keyboard="Numeric"
                    HorizontalOptions="FillAndExpand" />
                <Label
                    x:Name="UnitLabel"
                    VerticalOptions="Center" />
            </HorizontalStackLayout>
            <HorizontalStackLayout Spacing="12">
                <DatePicker x:Name="LogDatePicker" />
                <TimePicker x:Name="LogTimePicker" />
            </HorizontalStackLayout>
            <FlexLayout
                Direction="Row"
                Wrap="Wrap"
                AlignItems="Start"
                JustifyContent="Start">
                <Button
                    Text="Confirm"
                    Clicked="OnConfirmClicked"
                    Margin="0,0,4,4" />
            <Button
                Text="Cancel"
                Clicked="OnCancelClicked"
                Margin="0,0,4,4" />
        </FlexLayout>
    </VerticalStackLayout>

    <Grid
        x:Name="InvalidAmountOverlay"
        IsVisible="False">
        <BoxView Color="#80000000">
            <BoxView.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnInvalidAmountBackdropTapped" />
            </BoxView.GestureRecognizers>
        </BoxView>
        <Frame
            Padding="16"
            CornerRadius="12"
            BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
            HorizontalOptions="Center"
            VerticalOptions="Center"
            WidthRequest="320"
            HasShadow="True">
            <Frame.Shadow>
                <Shadow
                    Brush="#40000000"
                    Offset="0,8"
                    Radius="12"
                    Opacity="0.6" />
            </Frame.Shadow>
            <VerticalStackLayout Spacing="12">
                <Label
                    Text="Invalid Amount"
                    FontAttributes="Bold"
                    FontSize="18"
                    HorizontalTextAlignment="Center" />
                <Label
                    Text="Enter a valid amount."
                    HorizontalTextAlignment="Center" />
                <FlexLayout
                    Direction="Row"
                    Wrap="Wrap"
                    AlignItems="Center"
                    JustifyContent="Center">
                    <Button
                        Text="OK"
                        Clicked="OnInvalidAmountOkClicked"
                        Margin="0,0,4,4" />
                </FlexLayout>
            </VerticalStackLayout>
        </Frame>
    </Grid>

    <Grid
        x:Name="HelpOverlay"
        IsVisible="False"
        BackgroundColor="#80000000"
        RowDefinitions="*,Auto">
            <BoxView
                Grid.Row="0"
                BackgroundColor="Transparent">
                <BoxView.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnHelpDismissed" />
                </BoxView.GestureRecognizers>
            </BoxView>
            <Border
                x:Name="HelpSheet"
                Grid.Row="1"
                BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray950}}"
                Padding="20,16"
                StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16,16,0,0" />
                </Border.StrokeShape>
                <Grid RowDefinitions="Auto,*" RowSpacing="12">
                    <Grid ColumnDefinitions="*,Auto">
                        <Label
                            Text="{x:Static local:HelpContent.LogFoodTitle}"
                            FontAttributes="Bold"
                            FontSize="18"
                            VerticalOptions="Center" />
                        <Button
                            Grid.Column="1"
                            Text="Close"
                            Clicked="OnHelpDismissed"
                            Padding="6,2"
                            FontSize="12"
                            BackgroundColor="Transparent"
                            TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource White}}" />
                    </Grid>
                    <local:MarkdownView
                        Grid.Row="1"
                        MarkdownText="{x:Static local:HelpContent.LogFoodBody}"
                        VerticalOptions="FillAndExpand" />
                </Grid>
            </Border>
        </Grid>
    </Grid>

</ContentPage>
